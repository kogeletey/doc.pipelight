{
  "uuid": "981f58fe-ec09-4384-88ea-1c80a7449a36",
  "name": "deploy_to_single_host",
  "event": {
    "trigger": {
      "action": "manual",
      "branch": "dev",
      "tag": null
    },
    "date": "2023-07-21 14:52:58.285059847 +0200",
    "pid": 131134,
    "pgid": 131057,
    "sid": 3954
  },
  "status": "running",
  "duration": {
    "secs": 6,
    "nanos": 198275764
  },
  "triggers": [
    {
      "action": "pre-push",
      "branch": "master",
      "tag": null
    },
    {
      "action": "manual",
      "branch": "master",
      "tag": null
    },
    {
      "action": "pre-push",
      "branch": "main",
      "tag": null
    },
    {
      "action": "manual",
      "branch": "main",
      "tag": null
    },
    {
      "action": "pre-push",
      "branch": "dev",
      "tag": null
    },
    {
      "action": "manual",
      "branch": "dev",
      "tag": null
    }
  ],
  "fallback": {
    "on_started": null,
    "on_failure": null,
    "on_success": null,
    "on_abortion": null
  },
  "steps": [
    {
      "name": "build_files",
      "status": "succeeded",
      "duration": {
        "secs": 4,
        "nanos": 743066580
      },
      "commands": [
        {
          "duration": {
            "secs": 0,
            "nanos": 982869709
          },
          "process": {
            "uuid": "a2390e31-c162-43c2-be49-3eeeb5c04d9f",
            "state": {
              "status": "succeeded",
              "stdin": "pnpm install",
              "stdout": "Lockfile is up to date, resolution step is skipped\nAlready up to date\n\nDone in 924ms\n",
              "stderr": ""
            },
            "os": {
              "shell": "sh",
              "pid": 131186,
              "directory": "/var/log/pipelight",
              "attached": true
            }
          }
        },
        {
          "duration": {
            "secs": 3,
            "nanos": 759976996
          },
          "process": {
            "uuid": "798ab04c-9b65-4e13-b18b-6bfd12dc2974",
            "state": {
              "status": "succeeded",
              "stdin": "vite build",
              "stdout": "vite v4.3.1 building for production...\ntransforming...\n\nðŸŒ¼ daisyUI 3.0.20 \n âœ“ 669 modules transformed.\nrendering chunks...\ncomputing gzip size...\ndist/index.html                                  0.45 kB â”‚ gzip:  0.30 kB\ndist/assets/product-bbe8489e.css               0.36 kB â”‚ gzip:  0.17 kB\ndist/assets/collection-c3ae63aa.css              0.36 kB â”‚ gzip:  0.17 kB\ndist/assets/index-dc1b6ad3.js                  58.72 kB â”‚ gzip: 10.54 kB\n                161.97 kB â”‚ gzip: 60.82 kB\nâœ“ built in 3.24s\n",
              "stderr": ""
            },
            "os": {
              "shell": "sh",
              "pid": 131202,
              "directory": "/var/log/pipelight",
              "attached": true
            }
          }
        }
      ],
      "mode": null,
      "fallback": {
        "on_started": null,
        "on_failure": null,
        "on_success": null,
        "on_abortion": null
      }
    },
    {
      "status": "succeeded",
      "duration": {
        "secs": 1,
        "nanos": 454393825
      },
      "steps": [
        {
          "name": "build image itsdizygote.com/front:production",
          "status": "succeeded",
          "duration": {
            "secs": 1,
            "nanos": 453126173
          },
          "commands": [
            {
              "duration": {
                "secs": 1,
                "nanos": 452999541
              },
              "process": {
                "uuid": "a2eabec8-7c3d-487e-8288-3ec64ba2c97e",
                "state": {
                  "status": "succeeded",
                  "stdin": "docker build  --tag itsdizygote.com/front:production  --file .docker/Dockerfile.front   .",
                  "stdout": "",
                  "stderr": "#0 building with \"default\" instance using docker driver\n\n#1 [internal] load .dockerignore\n#1 transferring context: 2B done\n#1 DONE 0.0s\n\n#2 [internal] load build definition from Dockerfile.front\n#2 transferring dockerfile: 277B done\n#2 DONE 0.0s\n\n#3 [internal] load metadata for docker.io/library/archlinux:latest\n#3 DONE 1.2s\n\n#12 exporting layers done\n#12 writing image sha256:f0547343647bb06a2489c4d25cb44592d992dcada04a7e3566fee95190259fa4 done\n#12 naming to itsdizygote.com/front:production done\n#12 DONE 0.0s\n"
                },
                "os": {
                  "shell": "sh",
                  "pid": 131323,
                  "directory": "/var/log/pipelight",
                  "attached": true
                }
              }
            }
          ],
          "mode": null,
          "fallback": {
            "on_started": null,
            "on_failure": null,
            "on_success": null,
            "on_abortion": null
          }
        }
      ],
      "mode": null,
      "fallback": {
        "on_started": null,
        "on_failure": null,
        "on_success": null,
        "on_abortion": null
      }
    },
    {
      "status": "running",
      "duration": null,
      "steps": [
        {
          "name": "send image itsdizygote.com/front:production to remote",
          "status": "running",
          "duration": null,
          "commands": [
            {
              "duration": null,
              "process": {
                "uuid": "6fefeeea-e475-4cf4-938c-274099fa2307",
                "state": {
                  "status": "running",
                  "stdin": "docker save itsdizygote.com/front:production | ssh -o TCPKeepAlive=no -C linode \"docker load\"",
                  "stdout": null,
                  "stderr": null
                },
                "os": {
                  "shell": "sh",
                  "pid": null,
                  "directory": "/var/log/pipelight",
                  "attached": true
                }
              }
            }
          ],
          "mode": null,
          "fallback": {
            "on_started": null,
            "on_failure": null,
            "on_success": null,
            "on_abortion": null
          }
        }
      ],
      "mode": null,
      "fallback": {
        "on_started": null,
        "on_failure": null,
        "on_success": null,
        "on_abortion": null
      }
    },
    {
      "status": null,
      "duration": null,
      "steps": [
        {
          "name": "clean containers production.front.itsdizygote.com",
          "status": null,
          "duration": null,
          "commands": [
            {
              "duration": null,
              "process": {
                "uuid": "36b32d38-044f-4021-9c64-b8478ea1c588",
                "state": {
                  "status": null,
                  "stdin": "ssh -o TCPKeepAlive=no -C linode \"docker container stop production.front.itsdizygote.com && docker container rm production.front.itsdizygote.com\"",
                  "stdout": null,
                  "stderr": null
                },
                "os": {
                  "shell": "sh",
                  "pid": null,
                  "directory": "/var/log/pipelight",
                  "attached": true
                }
              }
            }
          ],
          "mode": null,
          "fallback": {
            "on_started": null,
            "on_failure": null,
            "on_success": null,
            "on_abortion": null
          }
        }
      ],
      "mode": null,
      "fallback": {
        "on_started": null,
        "on_failure": null,
        "on_success": null,
        "on_abortion": null
      }
    },
    {
      "status": null,
      "duration": null,
      "steps": [
        {
          "name": "run containers production.front.itsdizygote.com",
          "status": null,
          "duration": null,
          "commands": [
            {
              "duration": null,
              "process": {
                "uuid": "bfa1acf6-e2f1-45d8-821a-e7a85413da81",
                "state": {
                  "status": null,
                  "stdin": "ssh -o TCPKeepAlive=no -C linode \"docker run  --detach  --publish 127.0.0.1:9280:3000  --name production.front.itsdizygote.com  itsdizygote.com/front:production\"",
                  "stdout": null,
                  "stderr": null
                },
                "os": {
                  "shell": "sh",
                  "pid": null,
                  "directory": "/var/log/pipelight",
                  "attached": true
                }
              }
            }
          ],
          "mode": null,
          "fallback": {
            "on_started": null,
            "on_failure": null,
            "on_success": null,
            "on_abortion": null
          }
        }
      ],
      "mode": null,
      "fallback": {
        "on_started": null,
        "on_failure": null,
        "on_success": null,
        "on_abortion": null
      }
    }
  ]
}
